<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/ico" href="https://bitcoin.multipool.dev/favicon.ico">
  <link rel="apple-touch-icon" href="https://bitcoin.multipool.dev/favicon.ico">  
  <link rel="apple-touch-icon" sizes="76x76" href="https://bitcoin.multipool.dev/favicon.ico">
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7VDJYEP1R1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-7VDJYEP1R1');
  </script>
  <title>Crypto Mining Pools & Performance</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!--===============================================================================================-->    
  <link rel="icon" type="image/png" href="favicon.ico"/>
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="css/util.css">
  <link rel="stylesheet" type="text/css" href="css/main.css">
  <!--===============================================================================================-->
  <style>
    body {
      background: url('images/landscape.png') no-repeat center center fixed;
      background-size: cover;
      min-height: 300vh;
      color: #ffffff;
      margin: 0;
      padding: 0;
    }
    .crypto-icon { width: 24px; height: 24px; margin-right: 5px; vertical-align: middle; }
    .price { color: #28a745; }
    .error { color: #dc3545; }
    .widget-container { margin: 20px 0; }
    h3 { color: #ffffff; text-align: center; margin-bottom: 15px; }
    .table100-head th { 
      background-color: #333; 
      color: #ffffff; 
      padding: 10px; 
    }
    .container { 
      padding-top: 20px;
      min-height: 250vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    gecko-coin-list-widget { 
      width: 100%; 
      max-width: 600px; 
      margin: 0 auto; 
      display: block; 
    }
    table {
      width: 100%;
      max-width: 1200px;
      margin: 20px auto;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    td, th {
      padding: 10px;
      text-align: left;
    }
    .spacer {
      height: 150vh;
    }
    .fetch-info {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px;
      border-radius: 5px;
      font-size: 12px;
      z-index: 1000;
    }
    .fetch-info.success { color: #28a745; }
    .fetch-info.error { color: #dc3545; }
    .fetch-info.loading { color: #ffffff; }
  </style>
</head>
<body>
  <!-- Main CoinGecko Marquee Widget at the very top -->
  <script src="https://widgets.coingecko.com/gecko-coin-price-marquee-widget.js"></script>
  <gecko-coin-price-marquee-widget 
    locale="en" 
    dark-mode="true" 
    outlined="true" 
    coin-ids="tether,bitcoin,ethereum,trrxitte,traaitt,traaittxtcash,nyantereum,nyandoge-international,dogecoin,litecoin" 
    initial-currency="usd">
  </gecko-coin-price-marquee-widget>

  <div class="container">
    <!-- General Market Widget -->
    <div class="widget-container">
      <script src="https://widgets.coingecko.com/gecko-coin-list-widget.js"></script>
    </div>

    <!-- SHA-256 and CryptoNote Widgets -->
    <div class="row widget-container">
      <div class="col-md-6">
        <h3>General Market Performance</h3>
        <gecko-coin-list-widget 
          locale="en" 
          dark-mode="true" 
          outlined="true" 
          coin-ids="ethereum,bitcoin,bitcoin-cash,solana,binancecoin" 
          initial-currency="usd">
        </gecko-coin-list-widget>
      </div>
      <div class="col-md-6">
        <h3>TRRXITTE Int. Performance</h3>
        <gecko-coin-list-widget 
          locale="en" 
          dark-mode="true" 
          outlined="true" 
          coin-ids="trrxitte,nyantereum,traaitt,traaittxtcash,nyandoge-international" 
          initial-currency="usd">
        </gecko-coin-list-widget>
      </div>
    </div>

    <!-- SHA-256 and CryptoNote Widgets -->
    <div class="row widget-container">
      <div class="col-md-6">
        <h3>SHA-256 Coins Performance</h3>
        <gecko-coin-list-widget 
          locale="en" 
          dark-mode="true" 
          outlined="true" 
          coin-ids="bitcoin,bitcoin-cash,ecash,bitcoin-cash-sv" 
          initial-currency="usd">
        </gecko-coin-list-widget>
      </div>
      <div class="col-md-6">
        <h3>CryptoNote Coins Performance</h3>
        <gecko-coin-list-widget 
          locale="en" 
          dark-mode="true" 
          outlined="true" 
          coin-ids="monero,dash,zcash,arqma" 
          initial-currency="usd">
        </gecko-coin-list-widget>
      </div>
    </div>
    <br><br><br><br><!-- Mining Stats Table moved below the market widgets -->

    <!-- Image placeholder beneath the table -->
    <div style="width: 100%; text-align: center;">
      <a href="https://bitcoin.multipool.dev/" target="_blank">
        <img src="https://multipool.dev/images/btcportal.png" alt="Mining Stats Image" style="width: 100%; max-width: 100%; height: auto;">
      </a>
    </div>
    <table>
      <thead>
        <tr class="table100-head">
          <th class="column1">Cryptocurrency</th>
          <th class="column2">Price (USD)</th>
          <th class="column3">Mining Pool Url</th>
          <th class="column4">Hashrate</th>
          <th class="column5">Miners</th>
          <th class="column6">Fee</th>
          <th class="column7">Height</th>
          <th class="column8">Last Block</th>
          <th class="column9">Difficulty</th>
          <th class="column10">Tracking</th>
        </tr>
      </thead>
      <tbody id="cryptoTable">
        <!-- Data will be populated dynamically -->
      </tbody>
    </table>

    <!-- Spacer for additional scroll space -->
    <div class="spacer"></div>
  </div>

  <!-- Fetch Info Display -->
  <div id="fetchInfo" class="fetch-info loading">Loading price data...</div>

  <!--===============================================================================================-->    
  <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
  <!--===============================================================================================-->
  <script src="vendor/bootstrap/js/popper.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  <!--===============================================================================================-->
  <script src="vendor/select2/select2.min.js"></script>
  <!--===============================================================================================-->
  <script src="js/main.js"></script>

  <script>
    // Utility function to update fetch info display
    function updateFetchInfo(message, status) {
      const fetchInfo = document.getElementById('fetchInfo');
      fetchInfo.textContent = message;
      fetchInfo.className = `fetch-info ${status}`;
    }

    // Cache handling functions
    function getCachedPrices() {
      const cached = localStorage.getItem('cryptoPrices');
      return cached ? JSON.parse(cached) : null;
    }

    function setCachedPrices(prices) {
      localStorage.setItem('cryptoPrices', JSON.stringify({
        data: prices,
        timestamp: Date.now()
      }));
    }

    async function fetchCryptoData() {
      updateFetchInfo('Fetching price and pool data...', 'loading');
      const tableBody = document.getElementById('cryptoTable');
      tableBody.innerHTML = '<tr><td colspan="10">Loading cryptocurrency data...</td></tr>';

      try {
        const pools = [
          { 
            name: 'TRRXITTE XTE', 
            coingeckoId: 'traaitt',
            logoId: 'xte',
            poolUrl: 'https://xte.trrxitte.com/api/stats',
            displayUrl: 'xte.trrxitte.com',
            linkUrl: 'https://xte.trrxitte.com',
            tracking: 'Active',
            isMiningCore: false,
            defaultFee: '1'
          },
          { 
            name: 'TRRXITTE XTCASH', 
            coingeckoId: 'traaittxtcash',
            logoId: 'xtcash',
            poolUrl: 'https://xtcash.trrxitte.com/api/stats',
            displayUrl: 'xtcash.trrxitte.com',
            linkUrl: 'https://xtcash.trrxitte.com',
            tracking: 'Active',
            isMiningCore: false,
            defaultFee: '1'
          },
          { 
            name: 'Bitcoin', 
            coingeckoId: 'bitcoin',
            logoId: 'bitcoin',
            poolId: 'bitcoin',
            poolUrl: 'https://bitcoin.multipool.dev/api/pools/bitcoin/stats',
            blockUrl: 'https://bitcoin.multipool.dev/api/pools/bitcoin/blocks',
            configUrl: 'https://bitcoin.multipool.dev/api/pools/',
            displayUrl: 'Bitcoin at multipool',
            linkUrl: 'https://bitcoin.multipool.dev/#bitcoin/connect',
            tracking: 'Active',
            isMiningCore: true
          },
          { 
            name: 'Monero', 
            coingeckoId: 'monero',
            logoId: 'monero',
            poolId: 'monero',
            poolUrl: 'https://bitcoin.multipool.dev/api/pools/monero/stats',
            blockUrl: 'https://bitcoin.multipool.dev/api/pools/monero/blocks',
            configUrl: 'https://bitcoin.multipool.dev/api/pools/',
            displayUrl: 'Monero at multipool',
            linkUrl: 'https://bitcoin.multipool.dev/#monero/connect',
            tracking: 'Active',
            isMiningCore: true
          },
          { 
            name: 'Zcash', 
            coingeckoId: 'zcash',
            logoId: 'zcash',
            poolId: 'zcash',
            poolUrl: 'https://bitcoin.multipool.dev/api/pools/zcash/stats',
            blockUrl: 'https://bitcoin.multipool.dev/api/pools/zcash/blocks',
            configUrl: 'https://bitcoin.multipool.dev/api/pools/',
            displayUrl: 'ZCASH at multipool',
            linkUrl: 'https://bitcoin.multipool.dev/#zcash/connect',
            tracking: 'Active',
            isMiningCore: true
          },
          { 
            name: 'Dash', 
            coingeckoId: 'dash',
            logoId: 'dash',
            poolId: 'dash',
            poolUrl: 'https://bitcoin.multipool.dev/api/pools/dash/stats',
            blockUrl: 'https://bitcoin.multipool.dev/api/pools/dash/blocks',
            configUrl: 'https://bitcoin.multipool.dev/api/pools/',
            displayUrl: 'Dash at multipool',
            linkUrl: 'https://bitcoin.multipool.dev/#dash/connect',
            tracking: 'Active',
            isMiningCore: true
          },
          { 
            name: 'eCash', 
            coingeckoId: 'ecash',
            logoId: 'ecash',
            poolId: 'ecash',
            poolUrl: 'https://bitcoin.multipool.dev/api/pools/ecash/stats',
            blockUrl: 'https://bitcoin.multipool.dev/api/pools/ecash/blocks',
            configUrl: 'https://bitcoin.multipool.dev/api/pools/',
            displayUrl: 'eCash at multipool',
            linkUrl: 'https://bitcoin.multipool.dev/#ecash/connect',
            tracking: 'Active',
            isMiningCore: true
          },
          { 
            name: 'Bitcoin SV', 
            coingeckoId: 'bitcoin-cash-sv',
            logoId: 'bitcoinsv',
            poolId: 'bitcoinsv',
            poolUrl: 'https://bitcoin.multipool.dev/api/pools/bitcoinsv/stats',
            blockUrl: 'https://bitcoin.multipool.dev/api/pools/bitcoinsv/blocks',
            configUrl: 'https://bitcoin.multipool.dev/api/pools/',
            displayUrl: 'Bitcoin SV at multipool',
            linkUrl: 'https://bitcoin.multipool.dev/#bitcoinsv/connect',
            tracking: 'Active',
            isMiningCore: true
          },
          { 
            name: 'Dogecoin + Litecoin', 
            coingeckoId: 'dogecoin',
            logoId: 'dogecoin',
            mergedWith: 'litecoin',
            poolUrl: 'https://doge.multipool.dev/api/pool',
            displayUrl: 'DOGE + LTC at multipool',
            linkUrl: 'https://doge.multipool.dev',
            tracking: 'Active',
            isMiningCore: false,
            isDogepool: true,
            defaultFee: '1'
          }
        ];

        // Define Multipool logo mapping
        const multipoolLogos = {
          'bitcoin': 'https://multipool.dev/portal/images/bitcoin.png',
          'bitcoinsv': 'https://multipool.dev/portal/images/bitcoinsv.png',
          'dash': 'https://multipool.dev/portal/images/dash.png',
          'dogecoin': 'https://multipool.dev/portal/images/dogecoin.png',
          'ecash': 'https://multipool.dev/portal/images/ecash.png',
          'monero': 'https://multipool.dev/portal/images/monero.png',
          'xtcash': 'https://multipool.dev/portal/images/xtcash.png',
          'xte': 'https://multipool.dev/portal/images/xte.png',
          'zcash': 'https://multipool.dev/portal/images/zcash.png'
        };

        // Fetch CoinGecko data for prices with enhanced retry logic
        const coingeckoIds = [...new Set([...pools.map(pool => pool.coingeckoId), ...pools.filter(p => p.mergedWith).map(p => p.mergedWith)])].join(',');
        let priceData = {};

        async function fetchPricesWithRetry(attempts = 5, delay = 2000) {
          for (let i = 0; i < attempts; i++) {
            try {
              const response = await fetch(
                `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${coingeckoIds}&order=market_cap_desc&per_page=100&page=1&sparkline=false`,
                { headers: { 'Accept': 'application/json' } }
              );
              if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`CoinGecko API failed: ${response.status} - ${response.statusText} - ${errorText}`);
              }
              const coingeckoData = await response.json();
              if (!Array.isArray(coingeckoData) || coingeckoData.length === 0) {
                throw new Error('Empty or invalid response from CoinGecko');
              }
              coingeckoData.forEach(coin => {
                priceData[coin.id] = {
                  price: coin.current_price ?? 'N/A',
                  icon: coin.image || multipoolLogos[coin.id] || ''
                };
              });
              setCachedPrices(priceData);
              updateFetchInfo(`Prices fetched successfully at ${new Date().toLocaleTimeString()}`, 'success');
              return true;
            } catch (error) {
              console.warn(`Price fetch attempt ${i + 1}/${attempts} failed: ${error.message}`);
              if (i < attempts - 1) {
                updateFetchInfo(`Retrying price fetch (${i + 1}/${attempts})...`, 'loading');
                await new Promise(resolve => setTimeout(resolve, delay));
              } else {
                console.error('All price fetch attempts failed:', error);
                const cached = getCachedPrices();
                if (cached && (Date.now() - cached.timestamp) < 3600000) { // Use cache if < 1 hour old
                  priceData = cached.data;
                  updateFetchInfo(`Using cached prices from ${new Date(cached.timestamp).toLocaleTimeString()}`, 'success');
                  return true;
                } else {
                  updateFetchInfo('Failed to fetch prices after retries. No valid cache available.', 'error');
                  return false;
                }
              }
            }
          }
        }

        const pricesLoaded = await fetchPricesWithRetry();
        if (!pricesLoaded) {
          pools.forEach(pool => {
            priceData[pool.coingeckoId] = { price: 'N/A', icon: multipoolLogos[pool.logoId] || '' };
            if (pool.mergedWith) priceData[pool.mergedWith] = { price: 'N/A', icon: multipoolLogos[pool.mergedWith] || '' };
          });
        }

        // Fetch pool stats and configuration
        const poolStats = {};
        let config = { pools: [] };
        try {
          const poolConfigData = await fetch('https://bitcoin.multipool.dev/api/pools/');
          if (!poolConfigData.ok) throw new Error(`Pool config API failed: ${poolConfigData.status}`);
          config = await poolConfigData.json();
        } catch (configError) {
          console.error('Pool config fetch failed:', configError);
        }

        for (const pool of pools) {
          if (pool.isMiningCore) {
            try {
              const statsResponse = await fetch(pool.poolUrl);
              if (!statsResponse.ok) throw new Error(`Stats API failed for ${pool.name}: ${statsResponse.status}`);
              const statsData = await statsResponse.json();

              const blockResponse = await fetch(pool.blockUrl);
              if (!blockResponse.ok) throw new Error(`Blocks API failed for ${pool.name}: ${statsResponse.status}`);
              const blockData = await blockResponse.json();

              const poolConfig = config.pools.find(p => p.id === pool.poolId) || {};

              poolStats[pool.coingeckoId] = {
                pool: {
                  hashrate: statsData.poolStats?.poolHashrate || 0,
                  miners: statsData.poolStats?.connectedMiners || 'N/A',
                  fee: poolConfig.poolFeePercent || '1',
                  lastBlock: blockData.length > 0 ? new Date(blockData[0].created).toLocaleString() : 'N/A'
                },
                network: {
                  height: statsData.networkStats?.blockHeight || 'N/A',
                  difficulty: statsData.networkStats?.networkDifficulty || 'N/A'
                }
              };
            } catch (poolError) {
              console.error(`MiningCore fetch failed for ${pool.name}:`, poolError);
              poolStats[pool.coingeckoId] = {
                pool: { hashrate: 0, miners: 'N/A', fee: '1', lastBlock: 'N/A' },
                network: { height: 'N/A', difficulty: 'N/A' }
              };
            }
          } else if (pool.isDogepool) {
            try {
              const poolResponse = await fetch(pool.poolUrl);
              if (!poolResponse.ok) throw new Error(`Dogepool API failed for ${pool.name}: ${poolResponse.status}`);
              const statsData = await poolResponse.json();

              poolStats[pool.coingeckoId] = {
                pool: {
                  hashrate: statsData.hashrate || 0,
                  miners: statsData.miners || 'N/A',
                  fee: statsData.fee || pool.defaultFee,
                  lastBlock: statsData.lastBlock ? new Date(statsData.lastBlock).toLocaleString() : 'N/A'
                },
                network: {
                  height: statsData.height || 'N/A',
                  difficulty: statsData.difficulty || 'N/A'
                }
              };
            } catch (dogepoolError) {
              console.error(`Dogepool fetch failed for ${pool.name}:`, dogepoolError);
              poolStats[pool.coingeckoId] = {
                pool: { hashrate: 0, miners: 'N/A', fee: pool.defaultFee, lastBlock: 'N/A' },
                network: { height: 'N/A', difficulty: 'N/A' }
              };
            }
          } else {
            try {
              const poolResponse = await fetch(pool.poolUrl);
              if (!poolResponse.ok) throw new Error(`TRRXITTE API failed for ${pool.name}: ${poolResponse.status}`);
              const statsData = await poolResponse.json();
              poolStats[pool.coingeckoId] = {
                pool: {
                  hashrate: statsData.pool?.hashrate || 0,
                  miners: statsData.pool?.minerCount || 'N/A',
                  fee: pool.defaultFee,
                  lastBlock: statsData.pool?.lastBlock ? new Date(statsData.pool.lastBlock * 1000).toLocaleString() : 'N/A'
                },
                network: {
                  height: statsData.network?.height || 'N/A',
                  difficulty: statsData.network?.difficulty || 'N/A'
                }
              };
            } catch (trrxitteError) {
              console.error(`TRRXITTE fetch failed for ${pool.name}:`, trrxitteError);
              poolStats[pool.coingeckoId] = {
                pool: { hashrate: 0, miners: 'N/A', fee: pool.defaultFee, lastBlock: 'N/A' },
                network: { height: 'N/A', difficulty: 'N/A' }
              };
            }
          }
        }

        // Build table
        tableBody.innerHTML = '';
        for (const pool of pools) {
          try {
            const stats = poolStats[pool.coingeckoId];
            const poolStatsData = stats.pool || {};
            const networkStats = stats.network || {};

            const hashrate = poolStatsData.hashrate || 0;
            const miners = poolStatsData.miners || poolStatsData.minerCount || 'N/A';
            let fee = poolStatsData.fee;
            if (fee === 'N/A' && !pool.isMiningCore) {
              fee = pool.defaultFee;
            }
            const height = networkStats.height || 'N/A';
            const lastBlock = poolStatsData.lastBlock || 'N/A';
            const difficulty = networkStats.difficulty || 'N/A';

            let formattedHashrate = '';
            if (hashrate > 1000000000000) {
              formattedHashrate = (hashrate / 1000000000000).toFixed(2) + ' TH/s';
            } else if (hashrate > 1000000000) {
              formattedHashrate = (hashrate / 1000000000).toFixed(2) + ' GH/s';
            } else if (hashrate > 1000000) {
              formattedHashrate = (hashrate / 1000000).toFixed(2) + ' MH/s';
            } else if (hashrate > 1000) {
              formattedHashrate = (hashrate / 1000).toFixed(2) + ' KH/s';
            } else {
              formattedHashrate = hashrate.toFixed(2) + ' H/s';
            }

            let formattedDifficulty = '';
            if (typeof difficulty === 'number') {
              if (difficulty > 1000000000) {
                formattedDifficulty = (difficulty / 1000000000).toFixed(2) + ' G';
              } else if (difficulty > 1000000) {
                formattedDifficulty = (difficulty / 1000000).toFixed(2) + ' M';
              } else if (difficulty > 1000) {
                formattedDifficulty = (difficulty / 1000).toFixed(2) + ' K';
              } else {
                formattedDifficulty = difficulty.toFixed(2);
              }
            } else {
              formattedDifficulty = difficulty;
            }

            // Enhanced price display
            const formatPrice = (price) => {
              if (price === 'N/A' || price === undefined) return '$N/A';
              if (price >= 1) return `$${price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
              if (price >= 0.0001) return `$${price.toFixed(4)}`;
              if (price > 0) return `$${price.toFixed(8)}`;
              return '$0.00000000';
            };

            let priceDisplay = formatPrice(priceData[pool.coingeckoId]?.price);
            if (pool.mergedWith) {
              priceDisplay += ` / ${formatPrice(priceData[pool.mergedWith]?.price)}`;
            }

            const logoUrl = multipoolLogos[pool.logoId] || priceData[pool.coingeckoId]?.icon || '';

            const row = document.createElement('tr');
            row.innerHTML = `
              <td>
                <img src="${logoUrl}" 
                     class="crypto-icon" 
                     alt="${pool.name} icon" 
                     onerror="this.src='https://multipool.dev/portal/images/default.png'">
                ${pool.name}
              </td>
              <td class="price">${priceDisplay}</td>
              <td><a href="${pool.linkUrl}">${pool.displayUrl}</a></td>
              <td>${formattedHashrate}</td>
              <td>${miners}</td>
              <td>${fee}%</td>
              <td>${height}</td>
              <td>${lastBlock}</td>
              <td>${formattedDifficulty}</td>
              <td>${pool.tracking}</td>
            `;
            tableBody.appendChild(row);
          } catch (poolError) {
            console.error(`Error processing data for ${pool.name}:`, poolError);
            const row = document.createElement('tr');
            let priceDisplay = formatPrice(priceData[pool.coingeckoId]?.price);
            if (pool.mergedWith) {
              priceDisplay += ` / ${formatPrice(priceData[pool.mergedWith]?.price)}`;
            }
            const logoUrl = multipoolLogos[pool.logoId] || priceData[pool.coingeckoId]?.icon || '';
            row.innerHTML = `
              <td>
                <img src="${logoUrl}" 
                     class="crypto-icon" 
                     alt="${pool.name} icon" 
                     onerror="this.src='https://multipool.dev/portal/images/default.png'">
                ${pool.name}
              </td>
              <td class="price">${priceDisplay}</td>
              <td><a href="${pool.linkUrl}">${pool.displayUrl}</a></td>
              <td class="error">N/A</td>
              <td class="error">N/A</td>
              <td>${pool.isMiningCore ? '1' : pool.defaultFee}%</td>
              <td class="error">N/A</td>
              <td class="error">N/A</td>
              <td class="error">N/A</td>
              <td>${pool.tracking}</td>
            `;
            tableBody.appendChild(row);
          }
        }
      } catch (error) {
        console.error('Error in fetchCryptoData:', error);
        updateFetchInfo('Failed to load data. Please try refreshing.', 'error');
        tableBody.innerHTML = '<tr><td colspan="10" class="error">Failed to load data</td></tr>';
      }
    }

    // Initial fetch and refresh every 60 seconds (adjusted to avoid rate limits)
    fetchCryptoData();
    setInterval(fetchCryptoData, 60000);
  </script>
</body>
</html>